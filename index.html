<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>📊 تعديل البيانات عبر GitHub Actions</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      padding: 20px;
      text-align: center;
    }
    table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 90%;
      background: white;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
    }
    input {
      width: 80px;
      padding: 5px;
      margin: 5px;
    }
    button {
      padding: 10px 20px;
      margin-top: 10px;
      background-color: #28a745;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h2>📋 جدول البيانات</h2>

  <table id="data-table">
    <thead>
      <tr>
        <th>a</th><th>b</th><th>c</th><th>d</th><th>e</th>
      </tr>
    </thead>
    <tbody id="table-body">
      <!-- سيتم ملء البيانات -->
    </tbody>
  </table>

  <h3>➕ أضف صف جديد</h3>
  <input type="number" id="a" placeholder="a">
  <input type="number" id="b" placeholder="b">
  <input type="number" id="c" placeholder="c">
  <input type="number" id="d" placeholder="d">
  <input type="number" id="e" placeholder="e">
  <br>
  <button onclick="addRow()">💾 حفظ الصف</button>

  <script>
    let data = [];

    // تحميل البيانات الحالية من GitHub
    fetch("https://raw.githubusercontent.com/gity678/static/main/data.json")
      .then(res => res.json())
      .then(json => {
        data = json;
        renderTable();
      });

    function renderTable() {
      const tbody = document.getElementById("table-body");
      tbody.innerHTML = "";
      data.forEach(row => {
        const tr = document.createElement("tr");
        ["a", "b", "c", "d", "e"].forEach(key => {
          const td = document.createElement("td");
          td.textContent = row[key];
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    }

    function addRow() {
      const row = {
        a: parseInt(document.getElementById("a").value),
        b: parseInt(document.getElementById("b").value),
        c: parseInt(document.getElementById("c").value),
        d: parseInt(document.getElementById("d").value),
        e: parseInt(document.getElementById("e").value),
      };

      data.push(row);
      renderTable();
      sendToGitHub(data);
    }

    function sendToGitHub(data) {
      fetch("https://api.github.com/repos/gity678/static/dispatches", {
        method: "POST",
        headers: {
          "Accept": "application/vnd.github.everest-preview+json",
          "Authorization": "Bearer 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",
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          event_type: "update-data",
          client_payload: {
            json: JSON.stringify(data, null, 2)
          }
        })
      }).then(res => {
        if (res.ok) {
          alert("✅ تم إرسال البيانات إلى GitHub");
        } else {
          alert("❌ فشل في الإرسال إلى GitHub");
        }
      });
    }
  </script>

</body>
</html>
